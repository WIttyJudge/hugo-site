<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=theme-color content="dark"><title>How to set up WireGuard on your own Ubuntu 20.04 server | WittyJudge</title><meta property="og:site_name" content="WittyJudge personal blog, rss feed, csv"><meta property="og:title" content="How to set up WireGuard on your own Ubuntu 20.04 server | WittyJudge"><meta itemprop=name content="How to set up WireGuard on your own Ubuntu 20.04 server | WittyJudge"><meta name=twitter:title content="How to set up WireGuard on your own Ubuntu 20.04 server | WittyJudge"><meta name=application-name content="How to set up WireGuard on your own Ubuntu 20.04 server | WittyJudge"><meta name=twitter:card content="summary"><meta name=description content=" WireGuard is a lightweight communication protocol that implements encrypted virtual privacy network. In this guide, we will setup WireGuard VPN on your own Ubuntu 20.04 server. "><meta name=twitter:description content=" WireGuard is a lightweight communication protocol that implements encrypted virtual privacy network. In this guide, we will setup WireGuard VPN on your own Ubuntu 20.04 server.  "><meta itemprop=description content="  WireGuard is a lightweight communication protocol that implements encrypted virtual privacy network. In this guide, we will setup WireGuard VPN on your own Ubuntu 20.04 server.  "><meta property="og:description" content="  WireGuard is a lightweight communication protocol that implements encrypted virtual privacy network. In this guide, we will setup WireGuard VPN on your own Ubuntu 20.04 server.  "><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=stylesheet href=/sass/main.min.452e58c06e9b5d56ec2ecfc069a36c527dc08bc6d9daefce4dd9da6a9fe26403.css></head><script>(function(){const e="ThemeColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="ThemeColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.userColorScheme="dark":document.documentElement.dataset.userColorScheme="light"})()</script><body class=dark><nav class=navbar><div class=container><div class=flex><div><a class=brand href=/><span class=emoji>üë®üèªüíª</span></a></div><div class=flex><a href=/articles/>Articles</a>
<button id=dark-mode-button><svg class="light" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="1em" height="1em" style="-ms-transform:rotate(360deg);-webkit-transform:rotate(360deg);transform:rotate(360deg)" viewBox="0 0 36 36"><path fill="#ffd983" d="M30.312.776C32 19 20 32 .776 30.312c8.199 7.717 21.091 7.588 29.107-.429C37.9 21.867 38.03 8.975 30.312.776z"/><path d="M30.705 15.915a1.163 1.163.0 101.643 1.641 1.163 1.163.0 00-1.643-1.641zm-16.022 14.38a1.74 1.74.0 000 2.465 1.742 1.742.0 100-2.465zm13.968-2.147a2.904 2.904.0 01-4.108.0 2.902 2.902.0 010-4.107 2.902 2.902.0 014.108.0 2.902 2.902.0 010 4.107z" fill="#ffcc4d"/><rect x="0" y="0" width="36" height="36" fill="rgba(0, 0, 0, 0)"/></svg><svg class="dark" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="1em" height="1em" style="-ms-transform:rotate(360deg);-webkit-transform:rotate(360deg);transform:rotate(360deg)" viewBox="0 0 36 36"><path fill="#ffd983" d="M16 2s0-2 2-2 2 2 2 2v2s0 2-2 2-2-2-2-2V2zm18 14s2 0 2 2-2 2-2 2h-2s-2 0-2-2 2-2 2-2h2zM4 16s2 0 2 2-2 2-2 2H2s-2 0-2-2 2-2 2-2h2zm5.121-8.707s1.414 1.414.0 2.828-2.828.0-2.828.0L4.878 8.708s-1.414-1.414.0-2.829c1.415-1.414 2.829.0 2.829.0l1.414 1.414zm21 21s1.414 1.414.0 2.828-2.828.0-2.828.0l-1.414-1.414s-1.414-1.414.0-2.828 2.828.0 2.828.0l1.414 1.414zm-.413-18.172s-1.414 1.414-2.828.0.0-2.828.0-2.828l1.414-1.414s1.414-1.414 2.828.0.0 2.828.0 2.828l-1.414 1.414zm-21 21s-1.414 1.414-2.828.0.0-2.828.0-2.828l1.414-1.414s1.414-1.414 2.828.0.0 2.828.0 2.828l-1.414 1.414zM16 32s0-2 2-2 2 2 2 2v2s0 2-2 2-2-2-2-2v-2z"/><circle fill="#ffd983" cx="18" cy="18" r="10"/><rect x="0" y="0" width="36" height="36" fill="rgba(0, 0, 0, 0)"/></svg></button></div></div></div></nav><main><div class=container><article><header class=article-header><div class=thumb><div><h1>How to set up WireGuard on your own Ubuntu 20.04 server</h1><div class=post-meta><div>By WittyJudge | <time>April 15, 2022</time>
| 5 minutes</div><div class=tags><a href=/tags/vpn/>vpn</a>
<a href=/tags/opensource/>opensource</a></div></div></div></div></header></article><div class=article-post><h2 id=introduction><a href=#introduction class=anchor><svg class="icon" aria-hidden="true" focusable="false" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg></a>Introduction</h2><p><a href=https://www.wireguard.com/>WireGuard</a> is a lightweight communication protocol that implements encrypted virtual privacy network (VPN).</p><p><strong>In my humble opinion, if you are simple user, you should use VPN, because:</strong></p><ol><li>It gives you more freedom to access the internet safely from your smartphone or laptop when connected to a doubt network, like any public WiFi.</li><li>You have an access to websites blocked in your country for some reasons.</li></ol><p><strong>Here are just a few reasons why WireGuard is so awesome:</strong></p><ol><li>It implemented in less then 4,000 lines of code, it means that really <strong>easy to auditing and reviewing the code</strong> for security vulnerabilities.</li><li>It uses <strong>modern cryptography</strong> (<a href=http://www.noiseprotocol.org/>Noise protocol framework</a>, Curve25519, ChaCha20Poly1305, SipHash-2-4, HKDF, etc.).</li><li>It&rsquo;s an <strong>incredibly fast</strong>. Check out the performance comparison charts done by the Jason Donenfeld, the WireGuard author.</li></ol><ul><li><strong>Benchmarked</strong> alongside IPSec in two modes and OpenVPN.</li><li><strong>CPUs</strong>: Intel Core i7-3820QM and Intel Core i7-5200U.</li><li><strong>Ethernet Cards</strong>: Intel 82579LM and Intel I218LM gigabit Ethernet.</li></ul><p><img loading=lazy src=/img/setup-wireguard-vpn/performance-by-author.png alt="WireGuard performance charts published by author." width=803 height=380></p><p>If you&rsquo;re interested in setting up WireGuard on your own server, keep reading.</p><h2 id=prerequisites><a href=#prerequisites class=anchor><svg class="icon" aria-hidden="true" focusable="false" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg></a>Prerequisites</h2><p>To follow this tutorial, you will need:</p><ul><li>The setup steps are very similar, so you&rsquo;re free to use any Linux distribution you want, but in this guide I will use Ubuntu 20.04.
I would recommend you choosing a server with unlimited traffic or at least 1000 GB.</li><li>You will need a client machine that you will use to connect to your WireGuard server. In that guide, we will create configs for two clients, <strong>android</strong> and <strong>linux</strong>.</li></ul><h2 id=setup-steps><a href=#setup-steps class=anchor><svg class="icon" aria-hidden="true" focusable="false" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg></a>Setup steps</h2><p>Connect to your server.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh root@&lt;ip&gt;
</span></span></code></pre></div><h3 id=step-1---update-your-system><a href=#step-1---update-your-system class=anchor><svg class="icon" aria-hidden="true" focusable="false" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg></a>Step 1 - Update your system</h3><p>Update system packages to up-to-date version.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>apt update
</span></span><span class=line><span class=cl>apt upgrade
</span></span></code></pre></div><p>I also prefer to use <code>neovim</code> as my editor.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>apt install neovim
</span></span></code></pre></div><h3 id=step-2---installing-wireguard-on-server><a href=#step-2---installing-wireguard-on-server class=anchor><svg class="icon" aria-hidden="true" focusable="false" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg></a>Step 2 - Installing WireGuard on server</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>apt install wireguard
</span></span></code></pre></div><h3 id=step-3---enable-ip-forwarding-on-the-server><a href=#step-3---enable-ip-forwarding-on-the-server class=anchor><svg class="icon" aria-hidden="true" focusable="false" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg></a>Step 3 - Enable IP forwarding on the server</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;net.ipv4.ip_forward=1&#34;</span> &gt;&gt; /etc/sysctl.conf
</span></span></code></pre></div><p>Check out that the string was added.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sysctl -p
</span></span></code></pre></div><pre tabindex=0><code class=language-output data-lang=output>net.ipv4.ip_forward = 1
</code></pre><h3 id=step-4---generate-public-and-private-keys-of-server-and-clients><a href=#step-4---generate-public-and-private-keys-of-server-and-clients class=anchor><svg class="icon" aria-hidden="true" focusable="false" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg></a>Step 4 - Generate public and private keys of server and clients</h3><p>Change directory to <code>/etc/wireguard</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /etc/wireguard
</span></span></code></pre></div><p>Generate public and private server keys.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>wg genkey <span class=p>|</span> tee privatekey <span class=p>|</span> wg pubkey <span class=p>|</span> tee publickey
</span></span></code></pre></div><p>Then, generate keys for our clients.
Initialy, I prefer to create folder with the nickname or device of client that will use VPN.
In this guide, I will create configs for two clients, <strong>android</strong> and <strong>linux</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mkdir android
</span></span><span class=line><span class=cl>mkdir linux
</span></span></code></pre></div><p>Then, generate keys inside created folders.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>wg genkey <span class=p>|</span> tee android/privatekey <span class=p>|</span> wg pubkey <span class=p>|</span> tee android/publickey
</span></span><span class=line><span class=cl>wg genkey <span class=p>|</span> tee linux/privatekey <span class=p>|</span> wg pubkey <span class=p>|</span> tee linux/publickey
</span></span></code></pre></div><h3 id=step-5---create-server-config><a href=#step-5---create-server-config class=anchor><svg class="icon" aria-hidden="true" focusable="false" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg></a>Step 5 - Create server config</h3><p>Create config file and edit it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>touch wg0.conf
</span></span></code></pre></div><p><strong>wg0.conf</strong> will result in an interface named <strong>wg0</strong> therefore you can rename the file if you fancy something different.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nvim wg0.conf
</span></span></code></pre></div><p>Copy and paste following code to the <code>wg0.conf</code> file.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span>Interface<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>Address</span> <span class=o>=</span> 10.0.0.1/24
</span></span><span class=line><span class=cl><span class=nv>PostUp</span> <span class=o>=</span> iptables -A FORWARD -i %i -j ACCEPT<span class=p>;</span> iptables -A FORWARD -o %i -j ACCEPT<span class=p>;</span> iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
</span></span><span class=line><span class=cl><span class=nv>PostDown</span> <span class=o>=</span> iptables -D FORWARD -i %i -j ACCEPT<span class=p>;</span> iptables -D FORWARD -o %i -j ACCEPT<span class=p>;</span> iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE
</span></span><span class=line><span class=cl><span class=nv>ListenPort</span> <span class=o>=</span> <span class=m>51820</span>
</span></span><span class=line><span class=cl><span class=nv>PrivateKey</span> <span class=o>=</span> &lt;Server Private Key&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>Peer<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>PublicKey</span> <span class=o>=</span> &lt;Android client public key&gt;
</span></span><span class=line><span class=cl><span class=nv>AllowedIPs</span> <span class=o>=</span> 10.0.0.5/32
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>Peer<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>PublicKey</span> <span class=o>=</span> &lt;Linux client public key&gt;
</span></span><span class=line><span class=cl><span class=nv>AllowedIPs</span> <span class=o>=</span> 10.0.0.6/32
</span></span></code></pre></td></tr></table></div></div><p>Take a look at server&rsquo;s <code>PrivateKey</code> and peer&rsquo;s <code>PublicKey</code> sections.
It requires to copy and paste keys we generated recently.</p><h3 id=step-5---start-the-wireguard-server><a href=#step-5---start-the-wireguard-server class=anchor><svg class="icon" aria-hidden="true" focusable="false" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg></a>Step 5 - Start the WireGuard server</h3><p>Now start the service.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>systemctl <span class=nb>enable</span> wg-quick@wg0
</span></span><span class=line><span class=cl>systemctl start wg-quick@wg0
</span></span></code></pre></div><p>Double check that the WireGuard service is active with the following command. You have to see <code>active (running)</code> in the output:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>wg show wg0
</span></span></code></pre></div><pre tabindex=0><code class=language-output data-lang=output>interface: wg0
  public key: &lt;Public server key here&gt;
  private key: (hidden)
  listening port: 51820

peer: &lt;Public adroid client key here&gt;
  allowed ips: 10.0.0.5/32

peer: &lt;Public linux client key here&gt;
  allowed ips: 10.0.0.6/32
</code></pre><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>systemctl status wg-quick@wg0
</span></span></code></pre></div><pre tabindex=0><code class=language-output data-lang=output>‚óè wg-quick@wg0.service - WireGuard via wg-quick(8) for wg0
     Loaded: loaded (/lib/systemd/system/wg-quick@.service; enabled; vendor preset: enabled)
     Active: active (exited) since Thu 2022-04-14 19:08:04 UTC; 49min ago
       Docs: man:wg-quick(8)
             man:wg(8)
             https://www.wireguard.com/
             https://www.wireguard.com/quickstart/
             https://git.zx2c4.com/wireguard-tools/about/src/man/wg-quick.8
             https://git.zx2c4.com/wireguard-tools/about/src/man/wg.8
    Process: 32190 ExecStart=/usr/bin/wg-quick up wg0 (code=exited, status=0/SUCCESS)
   Main PID: 32190 (code=exited, status=0/SUCCESS)

Apr 14 19:08:04 wireguard systemd[1]: Starting WireGuard via wg-quick(8) for wg0...
Apr 14 19:08:04 wireguard wg-quick[32190]: [#] ip link add wg0 type wireguard
Apr 14 19:08:04 wireguard wg-quick[32190]: [#] wg setconf wg0 /dev/fd/63
Apr 14 19:08:04 wireguard wg-quick[32190]: [#] ip -4 address add 10.0.0.1/24 dev wg0
Apr 14 19:08:04 wireguard wg-quick[32190]: [#] ip link set mtu 1420 up dev wg0
Apr 14 19:08:04 wireguard wg-quick[32190]: [#] iptables -A FORWARD -i wg0 -j ACCEPT; iptables -A FORWARD -o wg0 -j ACCEPT; iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
Apr 14 19:08:04 wireguard systemd[1]: Finished WireGuard via wg-quick(8) for wg0.
</code></pre><h3 id=step-6---create-client-config-android><a href=#step-6---create-client-config-android class=anchor><svg class="icon" aria-hidden="true" focusable="false" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg></a>Step 6 - Create client config (Android)</h3><p>Create file called <strong>android-client.conf</strong> and add the following content.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span>Interface<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>PrivateKey</span> <span class=o>=</span> &lt;Android client private key&gt;
</span></span><span class=line><span class=cl><span class=nv>Address</span> <span class=o>=</span> 10.0.0.5/24
</span></span><span class=line><span class=cl><span class=nv>DNS</span> <span class=o>=</span> 1.1.1.1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>Peer<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>PublicKey</span> <span class=o>=</span> &lt;Server public key&gt;
</span></span><span class=line><span class=cl><span class=nv>Endpoint</span> <span class=o>=</span> &lt;SERVER-IP&gt;:51820
</span></span><span class=line><span class=cl><span class=nv>AllowedIPs</span> <span class=o>=</span> 0.0.0.0/0
</span></span><span class=line><span class=cl><span class=nv>PersistentKeepalive</span> <span class=o>=</span> <span class=m>20</span>
</span></span></code></pre></div><p><strong>AllowedIPs = 0.0.0.0/0</strong> will allow you to route all traffic through the VPN tunnel.</p><p>Now we need to transfer this config to the smartphone. Certainly, you can somehow move this file, but it&rsquo;s more convenient to use a QR-code.</p><p>Install <code>qrencode</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>apt install qrencode
</span></span></code></pre></div><p>Use it</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>qrencode -t ansiutf8 &lt; android-client.conf
</span></span></code></pre></div><p>After that we will see the QR code in terminal.
All we have to do is to scan it using WireGuard app on the mobile phone.
You can install it in <a href="https://play.google.com/store/apps/details?id=com.wireguard.android&hl=en_US&gl=US">Play Market</a> or <a href=https://f-droid.org/packages/com.wireguard.android>F-Droid</a></p></div></div><div class=container><nav class="flex container suggested"></nav></div><div class=container></div></main></main><footer class="footer flex"><section class=container><nav class=footer-links><a href=/index.xml>RSS</a></nav></section><script defer src=/ts/features.2f98c2f5215583b54b0a8bd7bdb10411467f4fee386a61e03ca3ddf376273fc4.js data-enable-footnotes=true></script></footer></body></html>